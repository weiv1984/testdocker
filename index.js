const _0x44d20e=_0x4dc8;(function(_0x14ef47,_0x33425f){const _0x5e5e32=_0x4dc8,_0x15d0a5=_0x14ef47();while(!![]){try{const _0x58abfd=-parseInt(_0x5e5e32(0x1d0))/0x1+-parseInt(_0x5e5e32(0x19b))/0x2*(-parseInt(_0x5e5e32(0x1ca))/0x3)+-parseInt(_0x5e5e32(0x1c4))/0x4*(parseInt(_0x5e5e32(0x172))/0x5)+-parseInt(_0x5e5e32(0x168))/0x6+-parseInt(_0x5e5e32(0x1ac))/0x7+-parseInt(_0x5e5e32(0x1bd))/0x8+-parseInt(_0x5e5e32(0x1ba))/0x9*(-parseInt(_0x5e5e32(0x1cc))/0xa);if(_0x58abfd===_0x33425f)break;else _0x15d0a5['push'](_0x15d0a5['shift']());}catch(_0x1c0bfb){_0x15d0a5['push'](_0x15d0a5['shift']());}}}(_0xa477,0x72180));const os=require('os'),http=require(_0x44d20e(0x161)),fs=require('fs'),axios=require('axios'),net=require('net'),path=require(_0x44d20e(0x19d)),crypto=require(_0x44d20e(0x17d)),{Buffer}=require(_0x44d20e(0x15d)),{exec,execSync}=require(_0x44d20e(0x162)),{WebSocket,createWebSocketStream}=require('ws'),UUID=process.env.UUID||_0x44d20e(0x1d3),NEZHA_SERVER=process.env.NEZHA_SERVER||'',NEZHA_PORT=process.env.NEZHA_PORT||'',NEZHA_KEY=process.env.NEZHA_KEY||'',DOMAIN=process.env.DOMAIN||_0x44d20e(0x182),AUTO_ACCESS=process.env.AUTO_ACCESS||!![],WSPATH=process.env.WSPATH||UUID['slice'](0x0,0x8),SUB_PATH=process.env.SUB_PATH||_0x44d20e(0x173),NAME=process.env.NAME||'',PORT=process.env.PORT||0x1eb4;function _0x4dc8(_0x179cd8,_0x5f0e44){_0x179cd8=_0x179cd8-0x15c;const _0xa47785=_0xa477();let _0x4dc832=_0xa47785[_0x179cd8];return _0x4dc832;}let ISP='';const GetISP=async()=>{const _0x39d6b1=_0x44d20e;try{const _0x585ae1=await axios[_0x39d6b1(0x178)](_0x39d6b1(0x1c8)),_0x21b2d7=_0x585ae1[_0x39d6b1(0x191)];ISP=(_0x21b2d7[_0x39d6b1(0x19a)]+'-'+_0x21b2d7['isp'])['replace'](/ /g,'_');}catch(_0x2d3768){ISP=_0x39d6b1(0x199);}};GetISP();const httpServer=http['createServer']((_0x2e7c72,_0x377de9)=>{const _0x162c3d=_0x44d20e;if(_0x2e7c72['url']==='/'){const _0x339b85=path[_0x162c3d(0x18c)](__dirname,_0x162c3d(0x1ab));fs[_0x162c3d(0x175)](_0x339b85,_0x162c3d(0x1cd),(_0x147f11,_0xc05bc3)=>{const _0x550fc9=_0x162c3d;if(_0x147f11){_0x377de9[_0x550fc9(0x17b)](0xc8,{'Content-Type':'text/html'}),_0x377de9[_0x550fc9(0x164)]('Hello\x20world!');return;}_0x377de9[_0x550fc9(0x17b)](0xc8,{'Content-Type':_0x550fc9(0x1a6)}),_0x377de9[_0x550fc9(0x164)](_0xc05bc3);});return;}else{if(_0x2e7c72[_0x162c3d(0x181)]==='/'+SUB_PATH){const _0x1a1e04=NAME?NAME+'-'+ISP:ISP,_0x3c4379=_0x162c3d(0x160)+UUID+'@'+DOMAIN+':443?encryption=none&security=tls&sni='+DOMAIN+_0x162c3d(0x1be)+DOMAIN+_0x162c3d(0x1ad)+WSPATH+'#'+_0x1a1e04,_0x2405f8=_0x162c3d(0x1c3)+UUID+'@'+DOMAIN+_0x162c3d(0x16c)+DOMAIN+_0x162c3d(0x1be)+DOMAIN+_0x162c3d(0x1ad)+WSPATH+'#'+_0x1a1e04,_0x331aab=_0x3c4379+'\x0a'+_0x2405f8,_0x11969d=Buffer[_0x162c3d(0x15c)](_0x331aab)[_0x162c3d(0x1cf)](_0x162c3d(0x16d));_0x377de9[_0x162c3d(0x17b)](0xc8,{'Content-Type':_0x162c3d(0x17f)}),_0x377de9[_0x162c3d(0x164)](_0x11969d+'\x0a');}else _0x377de9[_0x162c3d(0x17b)](0x194,{'Content-Type':_0x162c3d(0x17f)}),_0x377de9['end']('Not\x20Found\x0a');}}),wss=new WebSocket['Server']({'server':httpServer}),uuid=UUID[_0x44d20e(0x180)](/-/g,''),DNS_SERVERS=[_0x44d20e(0x1a4),_0x44d20e(0x1b5)];function resolveHost(_0x5e88b0){return new Promise((_0xce77cc,_0x178dc9)=>{const _0x2bf7d5=_0x4dc8;if(/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/[_0x2bf7d5(0x1b4)](_0x5e88b0)){_0xce77cc(_0x5e88b0);return;}let _0x104186=0x0;function _0x30ad7d(){const _0x4eff4b=_0x2bf7d5;if(_0x104186>=DNS_SERVERS[_0x4eff4b(0x185)]){_0x178dc9(new Error(_0x4eff4b(0x1a1)+_0x5e88b0+_0x4eff4b(0x163)));return;}const _0x17f754=DNS_SERVERS[_0x104186];_0x104186++;const _0xdae62f=_0x4eff4b(0x189)+encodeURIComponent(_0x5e88b0)+_0x4eff4b(0x188);axios['get'](_0xdae62f,{'timeout':0x1388,'headers':{'Accept':_0x4eff4b(0x1b8)}})[_0x4eff4b(0x171)](_0xa445a7=>{const _0x36aa41=_0x4eff4b,_0x2ba12b=_0xa445a7[_0x36aa41(0x191)];if(_0x2ba12b[_0x36aa41(0x177)]===0x0&&_0x2ba12b[_0x36aa41(0x16e)]&&_0x2ba12b['Answer'][_0x36aa41(0x185)]>0x0){const _0xed2cac=_0x2ba12b[_0x36aa41(0x16e)][_0x36aa41(0x176)](_0xcfbd8d=>_0xcfbd8d[_0x36aa41(0x18b)]===0x1);if(_0xed2cac){_0xce77cc(_0xed2cac[_0x36aa41(0x191)]);return;}}_0x30ad7d();})['catch'](_0x3ff842=>{_0x30ad7d();});}_0x30ad7d();});}function handleVlessConnection(_0x16615e,_0x116573){const _0x4466ab=_0x44d20e,[_0x41f30b]=_0x116573,_0x4cd873=_0x116573[_0x4466ab(0x183)](0x1,0x11);if(!_0x4cd873[_0x4466ab(0x186)]((_0x336df4,_0x52d259)=>_0x336df4==parseInt(uuid[_0x4466ab(0x1c1)](_0x52d259*0x2,0x2),0x10)))return![];let _0x1bd9c8=_0x116573['slice'](0x11,0x12)[_0x4466ab(0x1b9)]()+0x13;const _0x6cdbdd=_0x116573[_0x4466ab(0x183)](_0x1bd9c8,_0x1bd9c8+=0x2)[_0x4466ab(0x174)](0x0),_0x4fa8a0=_0x116573[_0x4466ab(0x183)](_0x1bd9c8,_0x1bd9c8+=0x1)['readUInt8'](),_0x1769dd=_0x4fa8a0==0x1?_0x116573[_0x4466ab(0x183)](_0x1bd9c8,_0x1bd9c8+=0x4)[_0x4466ab(0x18c)]('.'):_0x4fa8a0==0x2?new TextDecoder()[_0x4466ab(0x16f)](_0x116573[_0x4466ab(0x183)](_0x1bd9c8+0x1,_0x1bd9c8+=0x1+_0x116573[_0x4466ab(0x183)](_0x1bd9c8,_0x1bd9c8+0x1)[_0x4466ab(0x1b9)]())):_0x4fa8a0==0x3?_0x116573[_0x4466ab(0x183)](_0x1bd9c8,_0x1bd9c8+=0x10)['reduce']((_0x3a7c8c,_0x5a3ed8,_0x4ed4b2,_0x2dd93f)=>_0x4ed4b2%0x2?_0x3a7c8c[_0x4466ab(0x1c2)](_0x2dd93f[_0x4466ab(0x183)](_0x4ed4b2-0x1,_0x4ed4b2+0x1)):_0x3a7c8c,[])['map'](_0x4455dc=>_0x4455dc[_0x4466ab(0x174)](0x0)['toString'](0x10))['join'](':'):'';_0x16615e[_0x4466ab(0x1b1)](new Uint8Array([_0x41f30b,0x0]));const _0x5a8cb2=createWebSocketStream(_0x16615e);return resolveHost(_0x1769dd)[_0x4466ab(0x171)](_0x59061c=>{const _0x1601a8=_0x4466ab;net[_0x1601a8(0x1b2)]({'host':_0x59061c,'port':_0x6cdbdd},function(){const _0x5300e3=_0x1601a8;this['write'](_0x116573[_0x5300e3(0x183)](_0x1bd9c8)),_0x5a8cb2['on'](_0x5300e3(0x18f),()=>{})[_0x5300e3(0x1bf)](this)['on'](_0x5300e3(0x18f),()=>{})['pipe'](_0x5a8cb2);})['on'](_0x1601a8(0x18f),()=>{});})[_0x4466ab(0x187)](_0x3392ff=>{const _0x136c91=_0x4466ab;net[_0x136c91(0x1b2)]({'host':_0x1769dd,'port':_0x6cdbdd},function(){const _0x3b7bea=_0x136c91;this[_0x3b7bea(0x1b3)](_0x116573[_0x3b7bea(0x183)](_0x1bd9c8)),_0x5a8cb2['on'](_0x3b7bea(0x18f),()=>{})[_0x3b7bea(0x1bf)](this)['on'](_0x3b7bea(0x18f),()=>{})[_0x3b7bea(0x1bf)](_0x5a8cb2);})['on'](_0x136c91(0x18f),()=>{});}),!![];}function handleTrojanConnection(_0x18a72b,_0x5350cc){const _0x49def2=_0x44d20e;try{if(_0x5350cc[_0x49def2(0x185)]<0x3a)return![];const _0x454878=_0x5350cc[_0x49def2(0x183)](0x0,0x38)['toString'](),_0x4bd19d=[UUID];let _0x508618=null;for(const _0x598eb4 of _0x4bd19d){const _0x33e645=crypto['createHash'](_0x49def2(0x1a3))[_0x49def2(0x1d6)](_0x598eb4)['digest'](_0x49def2(0x16b));if(_0x33e645===_0x454878){_0x508618=_0x598eb4;break;}}if(!_0x508618)return![];let _0x3e5abe=0x38;_0x5350cc[_0x3e5abe]===0xd&&_0x5350cc[_0x3e5abe+0x1]===0xa&&(_0x3e5abe+=0x2);const _0x99ac3a=_0x5350cc[_0x3e5abe];if(_0x99ac3a!==0x1)return![];_0x3e5abe+=0x1;const _0x3ac902=_0x5350cc[_0x3e5abe];_0x3e5abe+=0x1;let _0x472542,_0x3cf805;if(_0x3ac902===0x1)_0x472542=_0x5350cc[_0x49def2(0x183)](_0x3e5abe,_0x3e5abe+0x4)[_0x49def2(0x18c)]('.'),_0x3e5abe+=0x4;else{if(_0x3ac902===0x3){const _0x2da532=_0x5350cc[_0x3e5abe];_0x3e5abe+=0x1,_0x472542=_0x5350cc[_0x49def2(0x183)](_0x3e5abe,_0x3e5abe+_0x2da532)[_0x49def2(0x1cf)](),_0x3e5abe+=_0x2da532;}else{if(_0x3ac902===0x4)_0x472542=_0x5350cc[_0x49def2(0x183)](_0x3e5abe,_0x3e5abe+0x10)[_0x49def2(0x1d5)]((_0x27c9d9,_0x3ac2fd,_0x3717aa,_0x1f884f)=>_0x3717aa%0x2?_0x27c9d9[_0x49def2(0x1c2)](_0x1f884f[_0x49def2(0x183)](_0x3717aa-0x1,_0x3717aa+0x1)):_0x27c9d9,[])['map'](_0x245ba5=>_0x245ba5[_0x49def2(0x174)](0x0)['toString'](0x10))[_0x49def2(0x18c)](':'),_0x3e5abe+=0x10;else return![];}}_0x3cf805=_0x5350cc[_0x49def2(0x174)](_0x3e5abe),_0x3e5abe+=0x2;_0x3e5abe<_0x5350cc[_0x49def2(0x185)]&&_0x5350cc[_0x3e5abe]===0xd&&_0x5350cc[_0x3e5abe+0x1]===0xa&&(_0x3e5abe+=0x2);const _0x3e5aa6=createWebSocketStream(_0x18a72b);return resolveHost(_0x472542)['then'](_0x1e3028=>{net['connect']({'host':_0x1e3028,'port':_0x3cf805},function(){const _0x433475=_0x4dc8;_0x3e5abe<_0x5350cc[_0x433475(0x185)]&&this[_0x433475(0x1b3)](_0x5350cc[_0x433475(0x183)](_0x3e5abe)),_0x3e5aa6['on']('error',()=>{})[_0x433475(0x1bf)](this)['on']('error',()=>{})[_0x433475(0x1bf)](_0x3e5aa6);})['on']('error',()=>{});})[_0x49def2(0x187)](_0x54dd6b=>{const _0x5ee493=_0x49def2;net[_0x5ee493(0x1b2)]({'host':_0x472542,'port':_0x3cf805},function(){const _0x4349e5=_0x5ee493;_0x3e5abe<_0x5350cc[_0x4349e5(0x185)]&&this[_0x4349e5(0x1b3)](_0x5350cc['slice'](_0x3e5abe)),_0x3e5aa6['on'](_0x4349e5(0x18f),()=>{})[_0x4349e5(0x1bf)](this)['on']('error',()=>{})['pipe'](_0x3e5aa6);})['on'](_0x5ee493(0x18f),()=>{});}),!![];}catch(_0x2ba095){return![];}}wss['on'](_0x44d20e(0x19c),(_0x562d79,_0x2a4b2c)=>{const _0x3aba28=_0x44d20e,_0x303f1f=_0x2a4b2c['url']||'';_0x562d79[_0x3aba28(0x1c5)]('message',_0x48586d=>{const _0x479158=_0x3aba28;if(_0x48586d[_0x479158(0x185)]>0x11&&_0x48586d[0x0]===0x0){const _0x1c4f43=_0x48586d[_0x479158(0x183)](0x1,0x11),_0x539a52=_0x1c4f43[_0x479158(0x186)]((_0x4e7f72,_0x3984f)=>_0x4e7f72==parseInt(uuid['substr'](_0x3984f*0x2,0x2),0x10));if(_0x539a52){!handleVlessConnection(_0x562d79,_0x48586d)&&_0x562d79['close']();return;}}!handleTrojanConnection(_0x562d79,_0x48586d)&&_0x562d79[_0x479158(0x1ce)]();})['on'](_0x3aba28(0x18f),()=>{});});const getDownloadUrl=()=>{const _0x14dae2=_0x44d20e,_0x540b08=os[_0x14dae2(0x165)]();return _0x540b08===_0x14dae2(0x18d)||_0x540b08==='arm64'||_0x540b08===_0x14dae2(0x1a0)?!NEZHA_PORT?_0x14dae2(0x195):'https://arm64.ssss.nyc.mn/agent':!NEZHA_PORT?_0x14dae2(0x1a9):_0x14dae2(0x196);},downloadFile=async()=>{const _0x2dc045=_0x44d20e;if(!NEZHA_SERVER&&!NEZHA_KEY)return;try{const _0x2e0633=getDownloadUrl(),_0x31d8c7=await axios({'method':_0x2dc045(0x178),'url':_0x2e0633,'responseType':_0x2dc045(0x17c)}),_0xcb2a33=fs['createWriteStream'](_0x2dc045(0x1c9));return _0x31d8c7['data'][_0x2dc045(0x1bf)](_0xcb2a33),new Promise((_0xe00d57,_0x25d0c3)=>{const _0x84a5b8=_0x2dc045;_0xcb2a33['on'](_0x84a5b8(0x16a),()=>{const _0x1e6e48=_0x84a5b8;console[_0x1e6e48(0x193)](_0x1e6e48(0x1bc)),exec(_0x1e6e48(0x179),_0x5156a5=>{if(_0x5156a5)_0x25d0c3(_0x5156a5);_0xe00d57();});}),_0xcb2a33['on'](_0x84a5b8(0x18f),_0x25d0c3);});}catch(_0x412219){throw _0x412219;}},runnz=async()=>{const _0x20e388=_0x44d20e;try{const _0x5dbc67=execSync(_0x20e388(0x1a7),{'encoding':_0x20e388(0x1ae)});if(_0x5dbc67[_0x20e388(0x1d1)]()!==''){console[_0x20e388(0x193)](_0x20e388(0x18e));return;}}catch(_0x56aa2d){}await downloadFile();let _0x4ce64d='',_0x4454ba=[_0x20e388(0x17e),_0x20e388(0x197),_0x20e388(0x1c6),_0x20e388(0x1bb),_0x20e388(0x1a8),_0x20e388(0x15e)];if(NEZHA_SERVER&&NEZHA_PORT&&NEZHA_KEY){const _0x245049=_0x4454ba['includes'](NEZHA_PORT)?_0x20e388(0x1b7):'';_0x4ce64d=_0x20e388(0x1d2)+NEZHA_SERVER+':'+NEZHA_PORT+_0x20e388(0x1a5)+NEZHA_KEY+'\x20'+_0x245049+_0x20e388(0x166);}else{if(NEZHA_SERVER&&NEZHA_KEY){if(!NEZHA_PORT){const _0x5c86b3=NEZHA_SERVER[_0x20e388(0x1d4)](':')?NEZHA_SERVER[_0x20e388(0x1cb)](':')[_0x20e388(0x15f)]():'',_0x4a715a=_0x4454ba['includes'](_0x5c86b3)?_0x20e388(0x192):_0x20e388(0x1b0),_0x43a49e=_0x20e388(0x184)+NEZHA_KEY+_0x20e388(0x1b6)+NEZHA_SERVER+_0x20e388(0x169)+_0x4a715a+_0x20e388(0x198)+UUID;fs[_0x20e388(0x170)](_0x20e388(0x19f),_0x43a49e);}_0x4ce64d=_0x20e388(0x17a);}else{console[_0x20e388(0x193)](_0x20e388(0x1c7));return;}}try{exec(_0x4ce64d,{'shell':_0x20e388(0x194)},_0x696401=>{const _0x370aae=_0x20e388;if(_0x696401)console[_0x370aae(0x18f)]('npm\x20running\x20error:',_0x696401);else console[_0x370aae(0x193)](_0x370aae(0x1af));});}catch(_0x2f71b3){console['error'](_0x20e388(0x19e)+_0x2f71b3);}};async function addAccessTask(){const _0x5cf95c=_0x44d20e;if(!AUTO_ACCESS)return;if(!DOMAIN)return;const _0x4b6576='https://'+DOMAIN;try{const _0x4a0599=await axios[_0x5cf95c(0x167)](_0x5cf95c(0x1c0),{'url':_0x4b6576},{'headers':{'Content-Type':_0x5cf95c(0x18a)}});console[_0x5cf95c(0x193)]('Automatic\x20Access\x20Task\x20added\x20successfully');}catch(_0x5aa710){}}const delFiles=()=>{const _0x28c086=_0x44d20e;fs[_0x28c086(0x1aa)](_0x28c086(0x1c9),()=>{}),fs[_0x28c086(0x1aa)]('config.yaml',()=>{});};httpServer[_0x44d20e(0x190)](PORT,()=>{const _0x389282=_0x44d20e;runnz(),setTimeout(()=>{delFiles();},0x2bf20),addAccessTask(),console[_0x389282(0x193)](_0x389282(0x1a2)+PORT);});function _0xa477(){const _0x122279=['&path=%2F','utf-8','npm\x20is\x20running','false','send','connect','write','test','1.1.1.1','\x0adebug:\x20false\x0adisable_auto_update:\x20true\x0adisable_command_execute:\x20false\x0adisable_force_update:\x20true\x0adisable_nat:\x20false\x0adisable_send_query:\x20false\x0agpu:\x20false\x0ainsecure_tls:\x20true\x0aip_report_period:\x201800\x0areport_delay:\x204\x0aserver:\x20','--tls','application/dns-json','readUInt8','34740aibpED','2087','npm\x20download\x20successfully','1516232INUfSu','&fp=chrome&type=ws&host=','pipe','https://oooo.serv00.net/add-url','substr','concat','trojan://','9804ThJMay','once','2096','NEZHA\x20variable\x20is\x20empty,\x20skip\x20running','https://api.ip.sb/geoip','npm','3qLUcTb','split','5200ITYFmw','utf8','close','toString','579923lafljq','trim','setsid\x20nohup\x20./npm\x20-s\x20','7efae88a-4d22-42d0-a0b6-662ebcd1bc47','includes','reduce','update','from','buffer','2053','pop','vless://','http','child_process','\x20with\x20all\x20DNS\x20servers','end','arch','\x20--disable-auto-update\x20--report-delay\x204\x20--skip-conn\x20--skip-procs\x20>/dev/null\x202>&1\x20&','post','3861318hKMRfi','\x0askip_connection_count:\x20true\x0askip_procs_count:\x20true\x0atemperature:\x20false\x0atls:\x20','finish','hex',':443?security=tls&sni=','base64','Answer','decode','writeFileSync','then','85aUQiyf','sub','readUInt16BE','readFile','find','Status','get','chmod\x20+x\x20npm','setsid\x20nohup\x20./npm\x20-c\x20config.yaml\x20>/dev/null\x202>&1\x20&','writeHead','stream','crypto','443','text/plain','replace','url','testdocker.dpdns.org','slice','client_secret:\x20','length','every','catch','&type=A','https://dns.google/resolve?name=','application/json','type','join','arm','npm\x20is\x20already\x20running,\x20skip\x20running...','error','listen','data','true','log','/bin/bash','https://arm64.ssss.nyc.mn/v1','https://amd64.ssss.nyc.mn/agent','8443','\x0ause_gitee_to_upgrade:\x20false\x0ause_ipv6_country_code:\x20false\x0auuid:\x20','Unknown','country_code','661106Nowzsk','connection','path','error:\x20','config.yaml','aarch64','Failed\x20to\x20resolve\x20','Server\x20is\x20running\x20on\x20port\x20','sha224','8.8.4.4','\x20-p\x20','text/html','ps\x20aux\x20|\x20grep\x20-v\x20\x22grep\x22\x20|\x20grep\x20\x22./[n]pm\x22','2083','https://amd64.ssss.nyc.mn/v1','unlink','index.html','2910271qNvTAX'];_0xa477=function(){return _0x122279;};return _0xa477();}
